(function(t){function e(e){for(var i,o,r=e[0],l=e[1],c=e[2],h=0,d=[];h<r.length;h++)o=r[h],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);m&&m(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,r=1;r<s.length;r++){var l=s[r];0!==n[l]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=s[0]))}return t}var i={},n={app:0},a=[];function o(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=i,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var m=l;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";s("85ec")},2506:function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);var i=s("2b0e"),n=s("5f5b");s("ab8b"),s("2dd8");i["default"].use(n["a"]);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"d-flex flex-column align-items-center",attrs:{id:"app"}},[t.started?s("Box",{staticClass:"px-5",attrs:{id:t.id,cols:t.cols,rows:t.rows,socket:t.socket,player:t.player,roomID:t.roomID,name:t.name,room:t.room}}):1==t.player?s("div",{staticClass:"d-inline-flex flex-column align-items-center mx-5"},[t.roomID?s("div",[s("p",{staticClass:"font-weight-bold text-light"},[t._v("Waiting for other player"),t.numberOfPlayers>2?s("span",[t._v("s")]):t._e()]),s("b-spinner",{attrs:{label:"Waiting...",variant:"info",type:"grow"}}),s("p",{staticClass:"pt-3 font-weight-bold text-light"},[t._v("Invite a friend to join using the link below.")]),s("p",{staticClass:"link text-info"},[t._v(t._s(t.host)+"?game="+t._s(t.roomID))]),s("b-button",{attrs:{variant:"outline-info px-3"},on:{click:t.copy}},[t._v(" "+t._s(t.copyCommand)+" ")])],1):s("div",{staticClass:"d-inline-flex flex-column align-items-center"},[s("div",{staticClass:"logo d-flex align-items-center px-3"},[s("div",{staticClass:"boxes"},[s("p",{staticClass:"title text-left small m-0 p-0 text-info font-weight-bold h1"},[t._v("â–¢â–£")]),s("p",{staticClass:"title text-left small m-0 p-0 text-info font-weight-bold h1"},[t._v("â–£â–¢")])]),s("span",{staticClass:"text-info h4 font-weight-cold title ml-3 my-auto"},[t._v("BoxRush")])]),s("p",{staticClass:"h3 font-weight-bold text-light title mt-3"},[t._v("Welcome!")]),s("p",{staticClass:"pt-3 font-weight-bold text-light"},[t._v(" This is the BoxRush game. "),s("br"),t._v(" Please choose grid size, number of players "),s("br"),t._v(" enter your first name, and start. ")]),s("p",{staticClass:"pt-3 font-weight-bold text-light"},[t._v("Grid Size")]),s("div",{staticClass:"d-flex align-items-center"},[s("b-form-spinbutton",{staticClass:"border-0 bg-transparent text-light font-weight-bold",attrs:{wrap:"",min:"4",max:"9",vertical:""},scopedSlots:t._u([{key:"increment",fn:function(){return[s("span",{staticClass:"text-light"},[t._v("â†‘")])]},proxy:!0},{key:"decrement",fn:function(){return[s("span",{staticClass:"text-light"},[t._v("â†“")])]},proxy:!0}],null,!1,830504397),model:{value:t.cols,callback:function(e){t.cols=e},expression:"cols"}}),s("span",{staticClass:"mx-3 font-weight-bold text-light"},[t._v("x")]),s("b-form-spinbutton",{staticClass:"border-0 bg-transparent text-light font-weight-bold",attrs:{wrap:"",min:"4",max:"9",vertical:""},scopedSlots:t._u([{key:"increment",fn:function(){return[s("span",{staticClass:"text-light"},[t._v("â†‘")])]},proxy:!0},{key:"decrement",fn:function(){return[s("span",{staticClass:"text-light"},[t._v("â†“")])]},proxy:!0}],null,!1,830504397),model:{value:t.rows,callback:function(e){t.rows=e},expression:"rows"}})],1),s("p",{staticClass:"pt-3 font-weight-bold text-light"},[t._v("Number of Players")]),s("div",{staticClass:"d-flex align-items-center mb-5"},[s("b-form-spinbutton",{staticClass:"border-0 bg-transparent text-light font-weight-bold",attrs:{wrap:"",min:"2",max:"4",vertical:""},scopedSlots:t._u([{key:"increment",fn:function(){return[s("span",{staticClass:"text-light"},[t._v("â†‘")])]},proxy:!0},{key:"decrement",fn:function(){return[s("span",{staticClass:"text-light"},[t._v("â†“")])]},proxy:!0}],null,!1,830504397),model:{value:t.numberOfPlayers,callback:function(e){t.numberOfPlayers=e},expression:"numberOfPlayers"}})],1),s("b-input-group",{staticClass:"d-inline-flex w-75"},[s("b-input",{staticClass:"bg-transparent text-light rounded mx-2",attrs:{type:"text",placeholder:"First name"},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.start.apply(null,arguments)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),s("b-button",{attrs:{variant:"outline-info px-3"},on:{click:t.start}},[t._v(" Start ")]),t.nameError?s("b-form-invalid-feedback",{staticClass:"text-left ml-4",attrs:{state:!1}},[t._v(" First name is required ")]):t._e()],1)],1)]):2==t.player?s("div",{staticClass:"d-inline-flex flex-column align-items-center m-5"},[t.expired||t.joined?!t.expired&&t.joined?s("div",[s("p",{staticClass:"font-weight-bold text-light"},[t._v("Waiting for other player"),t.numberOfPlayers>2?s("span",[t._v("s")]):t._e()]),s("b-spinner",{attrs:{label:"Waiting...",variant:"info",type:"grow"}})],1):t.expired?s("div",[s("p",{staticClass:"font-weight-bold text-danger"},[t._v(t._s(t.expired))]),s("b-button",{attrs:{variant:"outline-info",to:t.host}},[t._v(" Start a new one ")])],1):t._e():s("div",[s("div",{staticClass:"logo d-flex align-items-center px-3"},[s("div",{staticClass:"boxes"},[s("p",{staticClass:"title text-left small m-0 p-0 text-info font-weight-bold h1"},[t._v("â–¢â–£")]),s("p",{staticClass:"title text-left small m-0 p-0 text-info font-weight-bold h1"},[t._v("â–£â–¢")])]),s("span",{staticClass:"text-info h4 font-weight-cold title ml-3 my-auto"},[t._v("BoxRush")])]),s("p",{staticClass:"h3 font-weight-bold text-light title"},[t._v("Welcome!")]),s("p",{staticClass:"pt-3 mt-3 mb-5 font-weight-bold text-light"},[t._v(" This is the BoxRush game. "),s("br"),t._v(" Enter your first name and join. ")]),s("b-input-group",{staticClass:"d-inline-flex w-75"},[s("b-input",{staticClass:"bg-transparent text-light",attrs:{type:"text",placeholder:"First name"},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.join.apply(null,arguments)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),s("b-button",{attrs:{variant:"outline-info"},on:{click:t.join}},[t._v(" Join ")]),t.nameError?s("b-form-invalid-feedback",{staticClass:"text-left ml-4",attrs:{state:!1}},[t._v(" First name is required ")]):t._e()],1)],1)]):t._e(),1==t.player&&t.roomID||2==t.player&&t.joined?s("Chat",{attrs:{id:t.id,socket:t.socket,roomID:t.roomID,name:t.name,room:t.room}}):t._e()],1)},o=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.cols&&t.rows?s("div",{staticClass:"d-inline-block",staticStyle:{width:"100%","max-width":"500px"}},[t._m(0),s("div",{staticClass:"mb-4 d-flex flex-column justify-content-between align-items-end"},[s("p",{staticClass:"font-weight-bold text-light d-flex flex-column align-items-start"},[!t.turn&&t.winner&&"_DRAW_"!=t.winner?s("span",[t._v(" Winner: "),s("span",{staticClass:"badge badge-info p-2"},[t._v(t._s(t.winner))])]):t._e()]),s("div",{staticClass:"d-flex flex-row flex-wrap justify-content-start align-items-end w-100"},t._l(t.scores,(function(e,i){return s("p",{key:i,staticClass:"mx-auto font-weight-bold text-light btn m-0 p-0 d-inline-block text-left"},[s("span",{staticClass:"badge border border-info border-left-0 border-right-0 rounded-0 px-3 py-2"},[t._v(t._s(i))]),s("span",{staticClass:"badge badge-info  px-3 py-2"},[s("span",{staticClass:"h5 font-weight-bold"},[t._v(t._s(e))])])])})),0)]),t._l(2*t.rows+1,(function(e){return s("div",{key:e,staticClass:"d-flex"},t._l(2*t.cols+1,(function(i){return s("div",{key:i,staticClass:"d-flex",class:{"flex-grow-1":i%2==0}},[e%2!=0&&i%2!=0?s("div",{staticClass:"border border-secondary rounded-circle bg-secondary",staticStyle:{width:"10px",height:"10px"}}):e%2!=0&&i%2==0?s("div",{ref:i+"-"+e,refInFor:!0,staticClass:"mark bg-darkish flex-grow-1",class:{line:t.turn},staticStyle:{width:"10px"},attrs:{id:i+"-"+e},on:{click:function(s){return t.markX(i,e)}}}):e%2==0&&i%2!=0?s("div",{ref:i+"-"+e,refInFor:!0,staticClass:"mark bg-darkish",class:{line:t.turn},staticStyle:{height:"50px",width:"10px"},attrs:{id:i+"-"+e},on:{click:function(s){return t.markY(i,e)}}}):e%2==0&&i%2==0?s("div",{ref:i+"-"+e,refInFor:!0,staticClass:"m-auto box font-weight-bold",staticStyle:{width:"30px"},attrs:{id:i+"-"+e,state:0}}):t._e()])})),0)})),s("div",{staticClass:"my-3 d-flex flex-column justify-content-between align-items-end"},[s("p",{staticClass:"font-weight-bold text-light d-flex flex-column align-items-start"},[t.winner?t._e():s("span",{staticClass:"badge text-success p-2",class:{"text-success":t.turn,"text-danger":!t.turn},domProps:{textContent:t._s(t.turn?"Your move ..":"Opponents move ..")}}),!t.turn&&t.winner&&"_DRAW_"==t.winner?s("span",[s("span",{staticClass:"badge badge-info p-2"},[t._v(" ðŸ¤œ Draw ðŸ¤› ")])]):!t.turn&&t.winner&&t.winner==t.name?s("span",{staticClass:"text-left text-success font-weight-bold mt-2"},[t._v(" ðŸŽ‰ðŸ¥³ðŸŽ‰ You won. ")]):!t.turn&&t.winner&&t.winner!=t.name?s("span",{staticClass:"text-left text-danger font-weight-bold mt-2"},[t._v(" ðŸ˜”ðŸ˜ŸðŸ˜” You lost. ")]):t._e()])]),t.winner?s("div",{staticClass:"my-5"},[s("b-button",{attrs:{variant:"outline-info",to:t.origin}},[t._v(" New Game ")])],1):t._e()],2):t._e()},l=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"logo d-flex align-items-center px-3"},[s("div",{staticClass:"boxes"},[s("p",{staticClass:"title text-left small m-0 p-0 text-info font-weight-bold h1"},[t._v("â–¢â–£")]),s("p",{staticClass:"title text-left small m-0 p-0 text-info font-weight-bold h1"},[t._v("â–£â–¢")])]),s("span",{staticClass:"text-info h4 font-weight-cold title ml-3 my-auto"},[t._v("BoxRush")])])}],c={name:"Box",props:["id","cols","rows","player","socket","roomID","name","room"],data:()=>({turn:!1,scores:{},winner:null,origin:location.origin}),mounted(){this.room.players.forEach(t=>{this.scores[t.name]=0}),this.$forceUpdate(),1==this.player&&(this.turn=!0),this.socket.on("markedX",t=>{if(!this.$refs[t.col+"-"+t.row][0].hasAttribute("active")){if(t.row>1){let e=this.$refs[t.col+"-"+(t.row-1)][0];e.setAttribute("state",parseInt(e.getAttribute("state"))+1),4==parseInt(e.getAttribute("state"))&&(e.innerText=t.name.charAt(0),this.addScore(t.name))}if(t.row<2*this.rows+1){let e=this.$refs[t.col+"-"+(t.row+1)][0];e.setAttribute("state",parseInt(e.getAttribute("state"))+1),4==parseInt(e.getAttribute("state"))&&(e.innerText=t.name.charAt(0),this.addScore(t.name))}this.$refs[t.col+"-"+t.row][0].setAttribute("active",!0)}}),this.socket.on("markedY",t=>{if(!this.$refs[t.col+"-"+t.row][0].hasAttribute("active")){if(t.col>1){let e=this.$refs[t.col-1+"-"+t.row][0];e.setAttribute("state",parseInt(e.getAttribute("state"))+1),4==parseInt(e.getAttribute("state"))&&(e.innerText=t.name.charAt(0),this.addScore(t.name))}if(t.col<2*this.cols+1){let e=this.$refs[t.col+1+"-"+t.row][0];e.setAttribute("state",parseInt(e.getAttribute("state"))+1),4==parseInt(e.getAttribute("state"))&&(e.innerText=t.name.charAt(0),this.addScore(t.name))}this.$refs[t.col+"-"+t.row][0].setAttribute("active",!0)}}),this.socket.on("turn",t=>{this.id==t&&(this.turn=!0)}),this.socket.on("winner",t=>{this.winner||(this.winner=t.name,this.turn=!1)})},methods:{addScore(t){this.scores[t]?this.scores[t]+=1:this.scores[t]=1,this.$forceUpdate();var e=Object.keys(this.scores),s=0;if(e.forEach(t=>{s+=this.scores[t]}),s==this.rows*this.cols){var i=e[0];for(let t=1;t<e.length;t++)this.scores[e[t]]>this.scores[i]?i=e[t]:this.scores[e[t]]==this.scores[i]&&(i="_DRAW_");this.win(i)}},win(t){this.socket.emit("win",{roomID:this.roomID,name:t})},markX(t,e){if(this.turn&&!this.$refs[t+"-"+e][0].hasAttribute("active")){this.turn=!1;var s=!1;if(e>1){let i=this.$refs[t+"-"+(e-1)][0];i.setAttribute("state",parseInt(i.getAttribute("state"))+1),4==parseInt(i.getAttribute("state"))&&(i.innerText=this.name.charAt(0),this.addScore(this.name),s=!0)}if(e<2*this.rows+1){let i=this.$refs[t+"-"+(e+1)][0];i.setAttribute("state",parseInt(i.getAttribute("state"))+1),4==parseInt(i.getAttribute("state"))&&(i.innerText=this.name.charAt(0),this.addScore(this.name),s=!0)}this.$refs[t+"-"+e][0].setAttribute("active",!0),this.socket.emit("markX",{col:t,row:e,roomID:this.roomID,name:this.name}),s?this.turn=!0:this.socket.emit("next",this.roomID)}},markY(t,e){if(this.turn&&!this.$refs[t+"-"+e][0].hasAttribute("active")){this.turn=!1;var s=!1;if(t>1){let i=this.$refs[t-1+"-"+e][0];i.setAttribute("state",parseInt(i.getAttribute("state"))+1),4==parseInt(i.getAttribute("state"))&&(i.innerText=this.name.charAt(0),this.addScore(this.name),s=!0)}if(t<2*this.cols+1){let i=this.$refs[t+1+"-"+e][0];i.setAttribute("state",parseInt(i.getAttribute("state"))+1),4==parseInt(i.getAttribute("state"))&&(i.innerText=this.name.charAt(0),this.addScore(this.name),s=!0)}this.$refs[t+"-"+e][0].setAttribute("active",!0),this.socket.emit("markY",{col:t,row:e,roomID:this.roomID,name:this.name}),s?this.turn=!0:this.socket.emit("next",this.roomID)}}}},m=c,h=(s("7984"),s("2877")),d=Object(h["a"])(m,r,l,!1,null,null,null),p=d.exports,u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-box",class:{clip:t.clip}},[s("div",{staticClass:"overlay w-100 h-50"}),s("div",{staticClass:"messages-container text-white my-3 d-flex align-items-bottom justify-content-stretch"},[s("div",{staticClass:"messages mt-auto w-100 d-flex flex-column align-items-start"},[t._l(t.messages,(function(e,i){return s("div",{key:i,staticClass:"bubble m-2 p-2 px-3",class:{"align-self-end":e.id==t.id}},[s("div",{staticClass:"d-flex flex-column align-items-start"},[e.id!=t.id?s("p",{staticClass:"p-0 m-0 sender mb-1"},[t._v(t._s(e.name))]):t._e(),s("p",{staticClass:"p-0 m-0"},[t._v(t._s(e.message))])])])})),t.typing.length>0?s("p",{staticClass:"bubble sender m-2 p-2 pl-4"},[s("span",{domProps:{textContent:t._s(t.typing.map((function(t){return t.name})).join(", "))}}),s("span",{domProps:{textContent:t._s(t.typing.length>1?" are typing":" is typing")}}),s("span",{attrs:{id:"dots"}})]):t._e()],2)]),s("div",{staticClass:"d-flex flex-row align-items-center"},[s("b-input",{staticClass:"bg-transparent text-white message-box border-0 rounded-0 mx-2 p-2",attrs:{placeholder:"Message"},on:{focus:t.startTyping,blur:t.stopTyping,keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send.apply(null,arguments)}},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),s("div",{staticClass:"d-flex align-items-center"},[t.clip?t._e():s("i",{staticClass:"fab fa-rocketchat h3 text-info rounded-circle mt-1 d-flex align-items-center justify-content-center",staticStyle:{width:"40px",height:"40px"},on:{click:t.send}}),t.clip?s("i",{staticClass:"btn-clip far fa-comment-alt h3 text-info rounded-circle d-flex align-items-center justify-content-center",class:{glow:t.clip&&t.typing.length>0},staticStyle:{width:"40px",height:"40px"},on:{click:t.toggleClip}},[t.msgCount?s("b-badge",{attrs:{variant:"danger msg-badge"}},[t._v(t._s(t.msgCount))]):t._e()],1):s("i",{staticClass:"fa fa-times-circle h3 text-info rounded-circle mt-1 d-flex align-items-center justify-content-center",staticStyle:{width:"40px",height:"40px"},on:{click:t.toggleClip}})])],1)])},f=[],g={name:"Chat",props:["socket","id","roomID","name","room"],data:()=>({clip:!0,message:"",msgCount:0,messages:[],typing:[]}),mounted(){this.socket.on("message",t=>{this.messages.push({id:t.id,name:t.name,message:t.message}),this.$forceUpdate(),setTimeout(()=>{document.querySelector(".messages-container").scrollTop=document.querySelector(".messages-container").scrollHeight},100),this.clip&&this.msgCount++}),this.socket.on("start_typing",t=>{t.id!=this.id&&this.typing.push({id:t.id,name:t.name})}),this.socket.on("stop_typing",t=>{this.typing.splice(this.typing.indexOf(e=>e.id==t.id),1)})},methods:{toggleClip(){this.clip=!this.clip,this.clip||(this.msgCount=0)},send(){this.message=this.message.trim(),this.message&&(this.socket.emit("send",{roomID:this.roomID,id:this.id,name:this.name,message:this.message}),this.message="")},startTyping(){this.socket.emit("start_typing",{roomID:this.roomID,id:this.id,name:this.name})},stopTyping(){this.socket.emit("stop_typing",{roomID:this.roomID,id:this.id,name:this.name})}}},b=g,x=(s("650c"),Object(h["a"])(b,u,f,!1,null,"6b62660a",null)),v=x.exports,y={name:"App",components:{Box:p,Chat:v},data:()=>({host:location.origin,name:null,numberOfPlayers:2,nameError:null,cols:5,rows:5,socket:null,roomID:null,expired:null,player:1,room:null,started:!1,joined:!1,id:null,copyCommand:"Copy"}),mounted(){var t=new URLSearchParams(location.search);if(t.get("game")){var e=t.get("game");this.cols=Number.parseInt(e.split("-")[0]),this.rows=Number.parseInt(e.split("-")[1]),this.roomID=e,this.player=2}},methods:{start(){this.name?(this.nameError=!1,this.socket=io.connect(this.host+"/games"),this.socket.on("connect",()=>{console.log("Connected to server."),this.socket.emit("createRoom",{cols:this.cols,rows:this.rows,numberOfPlayers:this.numberOfPlayers})}),this.socket.on("roomCreated",t=>{console.log("Room created: ",t),this.roomID=t,this.socket.emit("join",{roomID:t,name:this.name})}),this.socket.on("joined",t=>{this.room=t}),this.socket.on("id",t=>{this.id=t}),this.socket.on("start",()=>{this.started=!0})):this.nameError=!0},join(){this.name?(this.nameError=!1,this.socket=io.connect(this.host+"/games"),this.socket.on("connect",()=>{console.log("Connected to server."),this.socket.emit("join",{roomID:this.roomID,name:this.name})}),this.socket.on("joined",t=>{this.room=t,this.joined=!0}),this.socket.on("id",t=>{this.id=t}),this.socket.on("start",()=>{this.started=!0}),this.socket.on("joinError",t=>{this.expired=t})):this.nameError=!0},async copy(){var t=this.host+"?game="+this.roomID;try{await navigator.clipboard.writeText(t),this.copyCommand="Copied",setTimeout(()=>this.copyCommand="Copy",3e3)}catch(e){console.error("Failed to copy text: ",e),this.copyCommand="Copy"}}}},w=y,C=(s("034f"),Object(h["a"])(w,a,o,!1,null,null,null)),_=C.exports;i["default"].config.productionTip=!1,new i["default"]({render:t=>t(_)}).$mount("#app")},"650c":function(t,e,s){"use strict";s("9c1b")},7984:function(t,e,s){"use strict";s("2506")},"85ec":function(t,e,s){},"9c1b":function(t,e,s){}});
//# sourceMappingURL=app.0445baa8.js.map